    /**
     * Asserts the connection is using a persistent resource stream.
     *
     * This assertion will trigger a connect() operation if the connection has
     * not been open yet.
     *
     * @param NodeConnectionInterface $connection Connection instance
     */

    protected function assertPersistentConnection(NodeConnectionInterface $connection): void
    {
        $this->assertSame('persistent stream', get_resource_type($connection->getResource()));
    }
