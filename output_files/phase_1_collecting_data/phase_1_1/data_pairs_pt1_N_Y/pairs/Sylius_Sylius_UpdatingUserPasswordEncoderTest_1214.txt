    /** @test */

    public function it_updates_the_encoder_when_the_shop_user_logs_in(): void
    {
        /** @var UserRepositoryInterface $shopUserRepository */
        $shopUserRepository = $this->client->getContainer()->get('sylius.repository.shop_user');

        /** @var ObjectManager $shopUserManager */
        $shopUserManager = $this->client->getContainer()->get('sylius.manager.shop_user');

        $shopUser = $shopUserRepository->findOneByEmail('Oliver@doe.com');
        $shopUser->setPlainPassword('testpassword');
        $shopUser->setEncoderName('argon2i');

        $shopUserManager->persist($shopUser);
        $shopUserManager->flush();

        $this->client->request('GET', '/en_US/login');

        $this->submitForm('Login', [
            '_username' => 'Oliver@doe.com',
            '_password' => 'testpassword',
        ]);

        Assert::assertSame(200, $this->client->getResponse()->getStatusCode());
        Assert::assertSame('/en_US/', parse_url($this->client->getCrawler()->getUri(), \PHP_URL_PATH));
        Assert::assertSame('sha512', $shopUserRepository->findOneByEmail('Oliver@doe.com')->getEncoderName());
    }
