    /**
     * Checks whether the client browser prefers safe content or not according to RFC8674.
     *
     * @see https://tools.ietf.org/html/rfc8674
     */

    public function preferSafeContent(): bool
    {
        if (null !== $this->isSafeContentPreferred) {
            return $this->isSafeContentPreferred;
        }

        if (!$this->isSecure()) {
            // see https://tools.ietf.org/html/rfc8674#section-3
            $this->isSafeContentPreferred = false;

            return $this->isSafeContentPreferred;
        }

        $this->isSafeContentPreferred = AcceptHeader::fromString($this->headers->get('Prefer'))->has('safe');

        return $this->isSafeContentPreferred;
    }
