/**
 * @coversDefaultClass \League\Csv\MapIterator
 */

final class MapIteratorTest extends TestCase
{
    public function testMapIteratorCanActLikeArrayMapWithOneArray(): void
    {
        $array = [1, 2, 3, 4, 5];
        $iterator = new ArrayIterator($array);
        $mapper = function (int $number): int {
            return ($number * $number * $number);
        };

        self::assertSame(
            array_map($mapper, $array),
            iterator_to_array(new MapIterator($iterator, $mapper), true)
        );
    }

    public function testMapIteratorCanAccessTheIteratorKey(): void
    {
        $expected = [
            'foo' => 'foo => bar',
            'bar' => 'bar => baz',
        ];
        $iterator = new ArrayIterator(['foo' => 'bar', 'bar' => 'baz']);
        $mapper = function (string $value, $offset): string {
            return $offset.' => '.$value;
        };

        self::assertSame(
            $expected,
            iterator_to_array(new MapIterator($iterator, $mapper), true)
        );
    }
}
