    /**
     * @covers ::insertOne
     * @dataProvider inputDataProvider
     */

    public function testInsertThrowsExceptionOnError(array $record): void
    {
        if (70400 > PHP_VERSION_ID) {
            $this->expectException(CannotInsertRecord::class);
            $this->expectExceptionMessage('Unable to write record to the CSV document');
        } else {
            self::expectNotice();
            $this->expectExceptionMessageMatches('/write of \d+ bytes failed with errno=9 Bad file descriptor/i');
        }

        Writer::createFromPath(__DIR__.'/../test_files/foo.csv', 'r')->insertOne($record);
    }
