    /**
     * @group disconnected
     */

    public function testAggregateOptionDoesNotTriggerAggregationInClient(): void
    {
        $arg1 = array('tcp://host1', 'tcp://host2');

        $connections = $this->getMockBuilder('Predis\Connection\FactoryInterface')->getMock();
        $connections
            ->expects($this->never())
            ->method('create');

        $connection = $this->getMockBuilder('Predis\Connection\AggregateConnectionInterface')
            ->getMock();
        $connection
            ->expects($this->never())
            ->method('add');

        $fnaggregate = $this->getMockBuilder('stdClass')
            ->addMethods(array('__invoke'))
            ->getMock();
        $fnaggregate
            ->expects($this->once())
            ->method('__invoke')
            ->with(
                $arg1,
                $this->isInstanceOf('Predis\Configuration\OptionsInterface'),
                $this->isInstanceOf('Predis\Configuration\OptionInterface')
            )
            ->willReturn($connection);

        $arg2 = array('aggregate' => $fnaggregate, 'connections' => $connections);

        $client = new Client($arg1, $arg2);

        $this->assertSame($connection, $client->getConnection());
    }
