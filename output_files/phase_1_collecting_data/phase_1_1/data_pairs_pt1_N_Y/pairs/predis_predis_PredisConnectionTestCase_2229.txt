    /**
     * Asserts the connection is not using a persistent resource stream.
     *
     * This assertion will trigger a connect() operation if the connection has
     * not been open yet.
     *
     * @param NodeConnectionInterface $connection Connection instance
     */

    protected function assertNonPersistentConnection(NodeConnectionInterface $connection): void
    {
        $this->assertSame('stream', get_resource_type($connection->getResource()));
    }
