    /**
     * @test The class returns the correct T² distances
     *
     * R code for expected values:
     *   model$calres$T2
     *
     * @throws \Exception
     */

    public function testGetT²Distances()
    {
        // Given
        $expected = [
            [0.9262786, 1.0048123, 1.701496, 1.764548,  2.149645,  3.525146,  5.071853,  5.953711,  7.103198],
            [0.9616837, 1.0249232, 1.490704, 1.760015,  2.157123,  3.275461,  5.054965,  5.734834,  5.947924],
            [0.9530838, 1.8998610, 1.940770, 1.943260,  1.943474,  3.146561,  4.760852,  5.086990,  5.811956],
            [0.9260216, 0.9351625, 2.791520, 2.906701,  3.752732,  3.757188,  3.764517,  3.801878,  4.733100],
            [0.8829120, 1.3162464, 1.632375, 4.374328,  4.638164,  4.689574,  4.726716,  4.738029,  5.882543],
            [0.9143322, 0.9144800, 3.771444, 4.332893,  6.477865,  6.496623,  7.064529,  7.822209,  7.822658],
            [0.8527711, 2.1326919, 2.201693, 2.774596,  2.830459,  3.637259,  5.335026,  6.434130,  7.810786],
            [1.0467445, 1.7164291, 2.047439, 3.672405,  3.751098,  4.753450,  6.231117,  6.329437,  6.330663],
            [1.2323981, 1.9453046, 2.932367, 6.689799,  6.692713,  7.089638,  9.676842,  9.780312, 11.480019],
            [1.0423675, 1.0531508, 1.190165, 2.638541,  3.372239,  3.683358,  4.265103,  4.910560,  5.394208],
            [1.0665781, 1.0739554, 1.132701, 3.428577,  4.293618,  4.564717,  4.596556,  6.145877,  6.156339],
            [0.8995364, 1.5337399, 1.787577, 1.796342,  1.864852,  2.882101,  2.956714,  3.041685, 10.036535],
            [0.9037232, 1.4026340, 1.648023, 1.724426,  2.003824,  3.988872,  3.996357,  4.041193,  5.683136],
            [0.9145147, 1.4879803, 1.836407, 1.841618,  1.945168,  3.454883,  3.895554,  4.580817,  5.459354],
            [0.9599115, 3.4744393, 3.977844, 4.735429,  4.917209,  6.950360,  7.875037,  8.057460, 10.818568],
            [0.9662034, 3.5751779, 3.984264, 4.715507,  5.159848,  7.420000,  8.225056,  8.669787,  8.696333],
            [0.9929637, 3.1411098, 3.294563, 3.306273,  3.901063,  4.788815,  6.502426, 10.895377, 13.192963],
            [1.0573498, 3.0741121, 3.164550, 3.635195,  3.907242,  4.015339,  4.788044,  6.845064,  8.937847],
            [1.0851687, 3.5731548, 3.810917, 4.996582, 10.022074, 11.264281, 11.717296, 11.947213, 14.722220],
            [1.0918644, 3.5805647, 3.656923, 4.563854,  4.812567,  5.618773,  5.834995,  8.333031,  8.373313],
            [0.9460550, 1.5999393, 2.751947, 2.919251,  3.691411,  3.884871,  9.131880,  9.649778,  9.842768],
            [0.8100177, 1.3195601, 1.879313, 2.413223,  3.614628,  3.672753,  3.778342,  6.475328,  6.570889],
            [0.8658151, 1.2228251, 1.657604, 2.416401,  2.417904,  2.604186,  2.658075,  6.475559,  6.583556],
            [0.8899282, 2.1064823, 2.386232, 3.462320,  7.546993,  7.834656,  9.154307,  9.696682, 10.083650],
            [0.8959346, 1.5170407, 1.974316, 4.672739,  5.049449,  5.201853,  6.311984,  6.521915,  7.329249],
            [0.9934248, 2.7324070, 2.757034, 2.951971,  2.957400,  2.960164,  3.074895,  3.117938,  3.143220],
            [1.0055527, 2.3276237, 3.653868, 4.007444,  4.102978,  8.267935,  8.785765,  9.434587,  9.816459],
            [0.9463721, 2.4732351, 3.496374, 3.990747, 10.248405, 10.857394, 10.877770, 11.343355, 11.404156],
            [1.0187610, 1.5328841, 5.793076, 8.876507,  8.962105, 13.678259, 15.272652, 17.543686, 17.589145],
            [0.9404946, 0.9431342, 4.844042, 7.244282,  8.950402,  9.439908, 10.071907, 10.252948, 10.317419],
            [1.0061556, 2.7573750,10.199559,11.487308, 13.668042, 14.319362, 16.257895, 19.052631, 19.199375],
            [1.0050816, 1.6075633, 1.612892, 1.956919,  3.197308,  4.276259,  5.284971,  5.285999,  6.726451],
        ];

        // When
        $T²Distances = self::$pca->getT2Distances()->getMatrix();

        // Then
        $this->assertEqualsWithDelta($expected, $T²Distances, .00001);
    }
