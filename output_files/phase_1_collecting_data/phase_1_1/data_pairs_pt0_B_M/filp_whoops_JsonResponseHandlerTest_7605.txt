    /**
     * @covers Whoops\Handler\JsonResponseHandler::addTraceToOutput
     * @covers Whoops\Handler\JsonResponseHandler::handle
     */

    public function testReturnsWithoutFrames()
    {
        $json = $this->getJsonResponseFromHandler($withTrace = false,$jsonApi = false);

        // Check that the response has the expected keys:
        $this->assertArrayHasKey('error', $json);
        $this->assertArrayHasKey('type', $json['error']);
        $this->assertArrayHasKey('file', $json['error']);
        $this->assertArrayHasKey('line', $json['error']);

        // Check the field values:
        $this->assertEquals($json['error']['file'], __FILE__);
        $this->assertEquals($json['error']['message'], 'test message');
        $this->assertEquals($json['error']['type'], get_class($this->getException()));

        // Check that the trace is NOT returned:
        $this->assertArrayNotHasKey('trace', $json['error']);
    }
