    /**
     * @test
     */

    public function cannot_use_from_collection_and_from_view_on_same_export()
    {
        $this->expectException(\Maatwebsite\Excel\Exceptions\ConcernConflictException::class);
        $this->expectExceptionMessage('Cannot use FromQuery, FromArray or FromCollection and FromView on the same sheet');

        $export = new class implements FromCollection, FromView
        {
            use Exportable;

            /**
             * @return Collection
             */
            public function collection()
            {
                return collect();
            }

            /**
             * @return View
             */
            public function view(): View
            {
                return view('users');
            }
        };

        $export->download('filename.csv');
    }
