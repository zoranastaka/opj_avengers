    /**
     * @test The class returns the correct T² distances
     *
     * R code for expected values:
     *   model$calres$T2
     *
     * @throws \Exception
     */

    public function testGetT²Distances()
    {
        // Given
        $expected = [
            [0.339876943,  0.3430128,  0.8493947,  4.927613,  5.545809,  5.790908,  6.056849,  6.117852,  7.061447],
            [0.339895260,  0.3430761,  0.8782271,  3.415242,  4.382091,  4.900601,  4.992631,  5.085169,  5.172425],
            [0.961699895,  0.9792681,  1.4746608,  1.560797,  3.200337,  5.853385,  5.882188,  6.136991,  6.454077],
            [0.003891668,  1.3943799,  1.5583647,  1.885812,  2.108561,  2.127915,  2.133523,  2.725832,  3.810801],
            [0.888353100,  1.5409758,  2.7325908,  2.908940,  3.532271,  3.752629,  3.949983,  3.992051,  5.020456],
            [0.028922586,  0.8757037,  1.9993918,  3.116968,  3.940855,  4.006878,  4.557400,  6.768822,  6.928645],
            [1.361457931,  2.0766251,  2.1237265,  2.136213,  2.864189,  2.892615,  5.313006,  5.354445,  8.388501],
            [0.680342156,  1.7633314,  1.7844036,  1.829912,  3.767661,  4.115386,  4.131434,  5.301613,  5.512901],
            [0.575041286,  0.6137885,  0.8715011, 10.810316, 12.337395, 12.352004, 15.877830, 16.614800, 17.891772],
            [0.241146939,  0.2676700,  1.6333474,  1.755643,  2.952532,  3.491177,  3.595860,  4.044514,  4.874136],
            [0.240791981,  0.2672968,  2.9291372,  2.930291,  4.110417,  4.512180,  5.351474,  6.350391,  6.437847],
            [0.163517709,  0.2374832,  0.5113982,  0.522952,  1.334101,  3.944278,  4.031543,  4.122149,  9.098221],
            [0.163294101,  0.2370941,  0.2899258,  0.349261,  1.077342,  4.306495,  4.306630,  4.317958,  4.931757],
            [0.163754318,  0.2376832,  1.0732214,  1.291515,  2.224334,  4.474674,  4.709970,  4.741759,  4.921688],
            [3.162843318,  5.0570880,  5.1620738,  5.185815,  8.032115,  9.109192,  9.123457,  9.236803,  9.900902],
            [2.997168473,  4.0042147,  4.1364271,  4.279705,  6.193548,  7.132974,  7.360966,  7.446104,  7.787415],
            [2.709438704,  2.8878324,  3.7916536,  4.289323,  5.826852,  5.841675,  7.752386,  7.753061, 12.253493],
            [1.593720042,  1.6234441,  5.0090443,  5.327596,  5.332335,  6.156731,  6.355428,  6.394352,  8.440727],
            [1.758731382,  1.9760945,  3.1147802,  3.863095,  4.482325,  4.544380,  5.108367, 12.543381, 14.197511],
            [1.732235644,  1.7442968,  6.7506893,  7.521198,  7.551643,  9.286568,  9.289278,  9.530301,  9.546421],
            [0.788327867,  0.7960385,  1.8329608,  3.900878,  5.620759,  6.582580, 10.206898, 10.273201, 11.738942],
            [0.344684102,  1.1856617,  1.5147513,  2.782633,  4.267608,  4.482483,  4.962541,  5.982325,  6.212670],
            [0.244933144,  0.8186205,  1.4828542,  2.121499,  3.761883,  4.048548,  5.243807,  5.465752,  5.654117],
            [1.212708604,  2.1349804,  2.1735904,  2.206969,  3.255012,  3.539895,  7.210885,  9.975644, 10.068155],
            [1.454321415,  3.0534849,  5.7648779,  6.011199,  6.038709,  6.092878,  6.147512,  6.186683,  6.430894],
            [1.585106253,  1.6154502,  1.6672079,  1.668438,  2.101718,  2.241767,  2.244587,  2.269272,  2.269476],
            [0.822262985,  0.8251146,  1.0457154,  3.098127,  3.105408,  7.458067,  7.836612,  7.854838,  9.337382],
            [1.008051950,  1.5730820,  4.8528219,  5.080813,  5.222567,  5.814607,  5.937723, 11.172155, 11.402293],
            [1.363273219,  3.3165080,  4.0394663,  4.319313,  4.989368,  8.078801, 17.424316, 20.397262, 20.919034],
            [0.224998733,  2.9482209,  3.5570675,  5.501168,  7.112509,  7.223873,  7.224169, 10.417485, 10.653922],
            [1.133533749, 14.4194622, 14.6852338, 15.484847, 16.604736, 16.803737, 16.813556, 17.518482, 18.549614],
            [0.711674544,  0.8430169,  1.7094930,  1.915909,  2.123009,  5.040118,  5.867190,  5.908551,  7.132357],
        ];

        // When
        $T²Distances = self::$pca->getT2Distances()->getMatrix();

        // Then
        $this->assertEqualsWithDelta($expected, $T²Distances, .00001);
    }
