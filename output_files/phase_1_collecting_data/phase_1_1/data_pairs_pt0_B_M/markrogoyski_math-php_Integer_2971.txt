    /**
     * Reduced totient function (Carmichael function, least universal exponent function)
     * Return the exponent of the multiplicative group of integers modulo n.
     *
     * Notation:
     *    λ(n)
     *
     * @see    https://en.wikipedia.org/wiki/Carmichael_function
     *
     * @param  int $n
     *
     * @return int the exponent of the multiplicative group of integers modulo n
     *
     * @throws Exception\OutOfBoundsException if n is < 1.
     */

    public static function reducedTotient(int $n): int
    {
        $primes = \array_count_values(self::primeFactorization($n));
        $λ      = 1;
        if (isset($primes[2]) && $primes[2] > 2) {
            --$primes[2];
        }

        foreach ($primes as $prime => $exponent) {
            $λ = Algebra::lcm($λ, $prime ** ($exponent - 1) * ($prime - 1));
        }

        return $λ;
    }
