    /**
     * Sets up the mcrypt module
     *
     * @param string $key
     *
     * @return void
     */

    private function prepareCipher($key)
    {
        if (0 !== mcrypt_generic_init($this->mcrypt, $key, $this->initv)) {
            throw new \RuntimeException('Failed to prepare mcrypt module');
        }
    }
