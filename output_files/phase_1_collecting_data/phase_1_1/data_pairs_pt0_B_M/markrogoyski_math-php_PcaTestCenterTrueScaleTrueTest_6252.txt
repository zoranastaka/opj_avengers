    /**
     * @test The class returns the correct T² distances
     *
     * R code for expected values:
     *   model$calres$T2
     *
     * @throws \Exception
     */

    public function testGetT²Distances()
    {
        // Given
        $expected = [
            [0.0780052327, 0.7393467, 0.8221398, 0.8820597, 3.969633, 4.095989, 5.80369, 5.803872, 7.061447],
            [0.0717867274, 0.5301802, 0.5545185, 0.5822158, 2.936674, 2.97207, 4.886617, 4.94145, 5.172425],
            [0.9350852706, 0.9863127, 1.0739, 1.1184216, 1.150143, 3.746545, 5.16563, 5.863217, 6.454077],
            [0.008195397, 1.8850397, 2.1003236, 2.4584085, 2.783241, 2.840001, 2.850363, 2.859973, 3.810801],
            [0.4452817489, 0.7751366, 2.8914441, 2.9734058, 3.244193, 3.514139, 3.54609, 3.942719, 5.020456],
            [0.0004350591, 2.8755423, 2.9003219, 5.7664314, 5.852765, 6.281691, 6.761476, 6.927837, 6.928645],
            [1.3026924773, 1.365302, 2.2085592, 2.2435748, 2.724338, 3.347002, 5.208813, 6.812961, 8.388501],
            [0.7384691114, 1.046344, 2.4758548, 2.7601935, 3.138064, 3.430987, 4.909784, 5.507969, 5.512901],
            [0.9312924774, 1.7499814, 9.4350614, 9.4447064, 10.599392, 10.937012, 13.683137, 16.604595, 17.891772],
            [0.025870603, 0.1880634, 1.746066, 1.7646973, 2.91175, 2.963255, 3.61231, 4.324267, 4.874136],
            [0.023752393, 0.1053558, 2.7219067, 2.7361821, 4.01036, 4.218878, 4.279483, 6.404731, 6.437847],
            [0.6280081903, 0.879845, 0.9640451, 1.1442959, 1.572224, 1.809402, 1.885041, 2.030133, 9.098221],
            [0.4937256968, 0.7388714, 0.9502169, 1.2660915, 1.696027, 2.612478, 2.623139, 3.191242, 4.931757],
            [0.5582552432, 0.8980874, 0.9126126, 1.2174087, 1.884765, 2.04143, 2.446618, 3.93731, 4.921688],
            [2.3549590602, 2.7866724, 4.3335709, 4.5103602, 5.171111, 5.636489, 6.554324, 7.059123, 9.900902],
            [2.4340085101, 2.7750747, 4.498922, 4.9376475, 5.578502, 5.992783, 6.770772, 7.749531, 7.787415],
            [1.9628882995, 2.0738046, 2.9657471, 4.5692409, 5.623403, 6.401991, 7.798527, 10.010509, 12.253493],
            [2.1073082516, 2.1972346, 2.2985705, 2.3364386, 2.948073, 5.600628, 6.179002, 6.254217, 8.440727],
            [2.6272041022, 2.8682357, 2.9701711, 8.3439967, 9.933367, 11.051658, 11.434494, 11.564842, 14.197511],
            [2.6273480696, 2.6993583, 2.8282095, 3.0102068, 3.513859, 9.179932, 9.278705, 9.463741, 9.546421],
            [0.640792567, 1.8285149, 1.8372076, 1.8612938, 3.23315, 3.275168, 8.583677, 11.430562, 11.738942],
            [0.5754129681, 1.1931425, 3.2073408, 4.5117327, 4.565284, 5.494759, 5.682529, 6.09889, 6.21267],
            [0.379378631, 0.8385401, 2.0046849, 2.0088158, 2.403048, 3.203543, 3.216953, 5.568976, 5.654117],
            [1.196452022, 1.4774966, 1.9520346, 5.3751114, 6.912575, 6.941366, 8.331189, 9.764625, 10.068155],
            [0.621080505, 1.0815515, 2.6804372, 2.8704164, 4.277772, 4.626787, 5.645129, 5.658026, 6.430894],
            [1.752464565, 1.783758, 2.0440939, 2.0595783, 2.065747, 2.139988, 2.241994, 2.249442, 2.269476],
            [1.365827867, 2.6534085, 2.9100132, 3.2936532, 4.314982, 8.161639, 8.82066, 9.011582, 9.337382],
            [1.4961289803, 2.4324321, 4.0977897, 7.1713728, 10.313411, 10.337612, 10.349212, 11.305518, 11.402293],
            [0.4237487167, 4.8061589, 5.3413089, 8.1684797, 12.211057, 14.287837, 15.657993, 20.791506, 20.919034],
            [0.0011457411, 3.8603637, 4.0961741, 9.0567294, 9.546292, 9.599614, 10.289639, 10.550459, 10.653922],
            [1.5517443671, 9.2339474, 10.2140058, 12.224765, 12.507492, 15.981726, 18.306654, 18.422492, 18.549614],
            [0.6412511483, 0.6468967, 0.9627476, 1.3320679, 1.407305, 3.275602, 4.196356, 5.893684, 7.132357],
        ];

        // When
        $T²Distances = self::$pca->getT2Distances()->getMatrix();

        // Then
        $this->assertEqualsWithDelta($expected, $T²Distances, .00001);
    }
