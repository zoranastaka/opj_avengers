	// --------------------------------------------------------------------

	public function test_valid_ip()
	{
		$this->assertTrue($this->input->valid_ip('192.18.0.1'));
		$this->assertTrue($this->input->valid_ip('192.18.0.1', 'ipv4'));
		$this->assertFalse($this->input->valid_ip('555.0.0.0'));
		$this->assertFalse($this->input->valid_ip('2001:db8:0:85a3::ac1f:8001', 'ipv4'));

		// v6 tests
		$this->assertFalse($this->input->valid_ip('192.18.0.1', 'ipv6'));

		$ip_v6 = array(
			'2001:0db8:0000:85a3:0000:0000:ac1f:8001',
			'2001:db8:0:85a3:0:0:ac1f:8001',
			'2001:db8:0:85a3::ac1f:8001'
		);

		foreach ($ip_v6 as $ip)
		{
			$this->assertTrue($this->input->valid_ip($ip));
			$this->assertTrue($this->input->valid_ip($ip, 'ipv6'));
		}
	}
