    /**
     * @param int|array|string $idSites
     * @return array
     * @throws \Piwik\NoAccessException
     */

    protected function getIdSites($idSites)
    {
        if ($idSites === 'all') {
            $idSites = $this->getSitesIdWithAtLeastViewAccess();
        }

        $idSites = Site::getIdSitesFromIdSitesString($idSites);

        if (empty($idSites)) {
            $this->throwNoAccessException("The parameter 'idSite=' is missing from the request.");
        }

        return $idSites;
    }
