    /**
     * Guess whether an input or output stream is piped.
     *
     * @param resource|int $stream
     *
     * @return bool
     */

    private static function looksLikeAPipe($stream)
    {
        if (\function_exists('posix_isatty')) {
            return !\posix_isatty($stream);
        }

        $stat = \fstat($stream);
        $mode = $stat['mode'] & 0170000;

        return $mode === 0010000 || $mode === 0040000 || $mode === 0100000 || $mode === 0120000;
    }
