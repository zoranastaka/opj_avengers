    /**
     * @test The class returns the correct T² distances
     *
     * R code for expected values:
     *   model$calres$T2
     *
     * @throws \Exception
     */

    public function testGetT²Distances()
    {
        // Given
        $expected = [
            [0.39724238,  0.4955328,  1.0107352,  1.011984,  5.262136,  5.985137,  6.041416,  6.307194,  7.103198],
            [0.39737026,  0.4961819,  1.0394939,  1.112160,  5.086388,  5.685733,  5.687369,  5.877438,  5.947924],
            [0.21108118,  0.6132141,  1.6348012,  2.037216,  3.570928,  3.804204,  5.280742,  5.340937,  5.811956],
            [0.81004162,  1.6865601,  2.4689015,  2.478230,  3.035183,  3.037505,  3.218021,  3.734317,  4.733100],
            [1.65910279,  2.4931653,  2.5008682,  3.948585,  4.129212,  4.718541,  4.739505,  4.745460,  5.882543],
            [0.64091037,  1.0330621,  1.6243372,  3.573587,  4.745230,  4.961151,  4.962583,  7.697190,  7.822658],
            [1.97104332,  2.2337116,  2.9975178,  3.152903,  3.908023,  3.912991,  4.302140,  5.274921,  7.810786],
            [0.26485827,  0.5052022,  2.6721295,  2.901541,  3.642781,  5.141223,  5.313665,  6.042054,  6.330663],
            [0.30656478,  0.3758509,  1.7117580,  5.888900,  6.591194,  9.235880,  9.254788,  9.395055, 11.480019],
            [0.45275462,  0.6841810,  1.0018329,  2.403666,  4.400057,  4.557816,  4.565583,  4.722648,  5.394208],
            [0.45257279,  0.6808486,  0.9423145,  4.061793,  5.659039,  5.765431,  6.011144,  6.138815,  6.156339],
            [1.13365042,  1.2011102,  1.2146473,  1.478561,  1.642785,  4.440156,  5.001102,  5.011356, 10.036535],
            [1.13401690,  1.2030229,  1.2071346,  1.315474,  1.532676,  4.420314,  5.104319,  5.118075,  5.683136],
            [1.13341273,  1.1994769,  1.2247746,  2.262394,  2.610304,  5.276850,  5.324540,  5.339923,  5.459354],
            [2.70528767,  5.7658823,  6.0549964,  6.202586,  7.225596, 10.140463, 10.155967, 10.211413, 10.818568],
            [2.65187148,  4.5859895,  5.0067042,  5.224546,  5.648375,  8.208427,  8.291319,  8.291337,  8.696333],
            [2.55733716,  3.2206870,  3.5802472,  3.907047,  3.952623,  5.715429,  8.028194,  8.471067, 13.192963],
            [0.11265288,  0.3462616,  3.5412324,  4.955404,  5.146787,  5.157718,  6.954012,  6.954112,  8.937847],
            [0.09216752,  0.1439657,  3.3639893,  4.345500,  5.500683,  5.502921,  5.523484, 12.728583, 14.722220],
            [0.09821853,  0.4174781,  3.9694498,  5.821141,  6.101578,  6.148249,  8.257111,  8.373308,  8.373313],
            [0.24934077,  0.5620521,  1.4654632,  3.353146,  6.898484,  7.165019,  7.255515,  8.814368,  9.842768],
            [1.27774486,  2.0887865,  2.1081432,  2.108268,  2.108648,  4.462481,  5.026745,  6.398673,  6.570889],
            [1.19231078,  1.7132519,  1.7307193,  1.868747,  1.894813,  4.610903,  6.299229,  6.316646,  6.583556],
            [1.89404828,  2.2997606,  3.1862551,  3.213313,  3.803266,  3.823318,  3.843035,  9.928316, 10.083650],
            [1.95465422,  3.9791245,  3.9983590,  6.885379,  6.889861,  6.915481,  6.963310,  7.063294,  7.329249],
            [0.11256367,  0.3273745,  2.5915613,  2.609473,  2.863564,  2.877255,  3.105730,  3.142093,  3.143220],
            [0.24029539,  0.4376568,  1.7589568,  2.705857,  3.093482,  4.052159,  8.145032,  8.249578,  9.816459],
            [0.21009568,  1.7268604,  3.0343241,  6.350443,  6.528738,  6.821419,  6.830694, 11.294811, 11.404156],
            [1.99094179,  3.0364915,  4.0700993,  5.501651,  5.823057,  6.038199, 17.443073, 17.448566, 17.589145],
            [0.48603990,  3.8650339,  3.8660253,  3.952498,  7.806997,  7.833270,  7.978534, 10.205848, 10.317419],
            [1.93767299, 11.6801964, 14.8965362, 14.927242, 14.941786, 15.562135, 17.410681, 18.141319, 19.199375],
            [0.27213397,  0.9020262,  1.5256914,  2.440765,  2.955724,  4.022225,  4.681417,  5.221283,  6.726451],
        ];

        // When
        $T²Distances = self::$pca->getT2Distances()->getMatrix();

        // Then
        $this->assertEqualsWithDelta($expected, $T²Distances, .00001);
    }
