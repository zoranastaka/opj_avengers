    /**
     * @test
     */

    public function can_force_remote_download_and_deletion_for_each_chunk_on_queue()
    {
        config()->set('excel.temporary_files.remote_disk', 'test');
        config()->set('excel.temporary_files.force_resync_remote', true);
        Bus::fake([AfterImportJob::class]);

        Queue::after(function (JobProcessed $event) {
            if ($event->job->resolveName() === ReadChunk::class) {
                $tempFile = $this->inspectJobProperty($event->job, 'temporaryFile');

                // Should not exist locally after each chunk
                $this->assertFalse(
                    $tempFile->existsLocally()
                );
            }
        });

        (new QueuedImport())->queue('import-batches.xlsx');
    }
